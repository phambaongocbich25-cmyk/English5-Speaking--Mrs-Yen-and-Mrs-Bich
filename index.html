<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English 5 Speaking</title>

<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&family=Pangolin&display=swap" rel="stylesheet">

<style>
:root{
 --primary:#4A90E2;
 --secondary:#6C5CE7;
 --accent:#27AE60;
 --error:#FF7F50;
 --bg:#F4F8FB;
 --gold:#F1C40F;
}

*{box-sizing:border-box}

body{
 margin:0;
 background:var(--bg);
 font-family:'Lexend',sans-serif;
}

.container{
 max-width:1000px;
 margin:auto;
 padding:16px;
}

h1{
 text-align:center;
 font-family:'Pangolin',cursive;
 color:var(--primary);
 font-size:2.8rem;
}

.mode-switch{
 display:flex;
 gap:10px;
 background:#eaf1f8;
 padding:8px;
 border-radius:40px;
}

.mode-btn{
 flex:1;
 padding:14px;
 border:none;
 border-radius:40px;
 font-weight:bold;
 cursor:pointer;
 background:transparent;
}

.mode-btn.active{
 background:var(--primary);
 color:white;
}

.input-bar{
 display:grid;
 gap:12px;
 margin:20px 0;
}

@media(min-width:600px){
 .input-bar{grid-template-columns:1fr 1fr;}
}

input,select,textarea{
 width:100%;
 padding:14px;
 border-radius:18px;
 border:2px solid #dfe6ee;
 font-size:1rem;
}

.card{
 background:white;
 padding:20px;
 border-radius:24px;
 margin-bottom:20px;
}

.sample{
 background:#f9fbff;
 border-left:6px solid var(--accent);
 padding:16px;
 border-radius:14px;
 line-height:1.7;
}

button{
 width:100%;
 padding:16px;
 border-radius:40px;
 border:none;
 font-size:1.2rem;
 font-weight:bold;
 cursor:pointer;
}

.record{
 background:linear-gradient(135deg,var(--primary),var(--secondary));
 color:white;
}

.listen{
 margin-top:10px;
 background:white;
 border:2px solid var(--primary);
 color:var(--primary);
}

.correct{color:var(--accent);font-weight:bold}
.fix{color:var(--error);font-weight:bold;text-decoration:underline;cursor:pointer}

#cert{
 display:none;
 background:#fffdf5;
 border:10px solid #fdcb6e;
 padding:30px;
 border-radius:20px;
 text-align:center;
}

.cert-name{
 font-family:'Pangolin',cursive;
 font-size:2.4rem;
 color:var(--secondary);
 border-bottom:3px solid #ccc;
 display:inline-block;
 padding:0 20px;
 margin:20px 0;
}

.stars{font-size:3rem;color:var(--gold)}

.footer{
 display:flex;
 justify-content:space-around;
 margin-top:40px;
 flex-wrap:wrap;
 gap:20px;
}

.signature{
 border-top:2px solid #999;
 padding-top:8px;
 font-family:'Pangolin',cursive;
}
</style>
</head>

<body>
<div class="container">

<h1>English 5 Speaking</h1>

<div class="mode-switch">
 <button id="btnUnit" class="mode-btn active" onclick="setMode('unit')">Theo Unit</button>
 <button id="btnFree" class="mode-btn" onclick="setMode('free')">Free Speaking</button>
</div>

<div class="input-bar">
 <input id="nameInp" placeholder="T√™n h·ªçc sinh">
 <input id="classInp" placeholder="L·ªõp (VD: 5/3)">
</div>

<div id="unitSection" class="card">
 <select id="unitSel"></select>
 <div id="sampleTxt" class="sample"></div>
 <button class="listen" onclick="playVoice(sampleTxt.innerText)">üîä Nghe b√†i m·∫´u</button>
</div>

<div id="freeSection" class="card" style="display:none">
 <div class="sample">Con h√£y n√≥i t·ª± do. C√¥ AI s·∫Ω s·ª≠a c√¢u cho ƒë√∫ng.</div>
</div>

<div class="card">
 <textarea id="output" rows="3" placeholder="L·ªùi con n√≥i s·∫Ω hi·ªán ·ªü ƒë√¢y..."></textarea>
 <button id="recBtn" class="record" onclick="startRec()">üéôÔ∏è B·∫ÆT ƒê·∫¶U N√ìI</button>
</div>

<div class="card">
 <b>ü§ñ Nh·∫≠n x√©t:</b>
 <div id="feedback">ƒêang ch·ªù con n√≥i‚Ä¶</div>
</div>

<div id="cert">
 <h2>CERTIFICATE</h2>
 <p>This certificate is presented to</p>
 <div id="cName" class="cert-name"></div>
 <p>L·ªõp: <span id="cClass"></span></p>
 <h3 id="cUnit"></h3>
 <div id="cStars" class="stars"></div>
 <div class="footer">
  <div class="signature">Mrs Tran Thi Kim Yen</div>
  <div class="signature">Mrs Pham Thi Ngoc Bich</div>
 </div>
</div>

</div>

<script>
/* ===== LOCK ENGLISH VOICE ‚Äì NEVER VIETNAMESE ===== */
let voices = [];

function initVoices(){
  voices = speechSynthesis.getVoices().filter(v =>
    v.lang.startsWith("en") && !v.lang.startsWith("vi")
  );
}
speechSynthesis.onvoiceschanged = initVoices;
initVoices();

/* ===== LESSON CONTENT (ƒê√öNG M·∫™U C√ÇU) ===== */
const lessons={
1:"My name is Hoang. I‚Äôm in class 5/3. I live in the countryside. My favourite colour is yellow. My favourite animal is a dolphin. My favourite food is a sandwich. My favourite sport is table tennis.", 
2:"Do you live in this house? Yes, I do. What‚Äôs your address? It‚Äôs 65 Le Loi Street.",
3:"What nationality is he? He is Vietnamese. What‚Äôs he like? He is friendly and helpful.",
4:"What do you like doing in your free time? I like watering the flowers and playing the violin.",
5:"What would you like to be in the future? I want to be a teacher because I want to teach children.",
6:"Could you tell me the way to the art room, please? Go upstairs, go past the library and turn right.",
7:"What school activity does she like? She likes doing projects because she thinks it is interesting.",
8:"Where are the crayons? They are on the table. Whose pen is this? It‚Äôs Huong‚Äôs.",
9:"Were you at the campsite last week? Yes, we were. We danced around the campfire.",
10:"Did they go to Ba Na Hills? Yes, they did. They visited the old buildings.",
11:"Did you swim? Yes, I did. I swam with my family.",
12:"Will you make banh chung for Tet? Yes, I will. I will visit my grandparents.",
13:"What will you do on Children‚Äôs Day? We will sing and dance.",
14:"How does she stay healthy? She does yoga twice a week and eats healthy food.",
15:"What‚Äôs the matter? I have a sore throat. You should rinse your mouth with salt water.",
16:"How‚Äôs the weather in summer? It‚Äôs hot. What do you usually wear? I wear a blouse.",
17:"Who are the main characters? They are the fox and the crow.",
18:"How can I get to Dragon Bridge? You can get there by bus.",
19:"What do you think of Hoi An Old Town? I think it is peaceful.",
20:"Where are you going to visit this summer? I‚Äôm going to visit Phong Nha Cave."
};

/* ===== INIT ===== */
const unitSel=document.getElementById("unitSel");
const sampleTxt=document.getElementById("sampleTxt");
const feedback=document.getElementById("feedback");

for(let i=1;i<=20;i++){
 unitSel.innerHTML+=`<option value="${i}">Unit ${i}</option>`;
}
sampleTxt.innerText=lessons[1];
unitSel.onchange=()=>sampleTxt.innerText=lessons[unitSel.value];

/* ===== MODE ===== */
function setMode(m){
 btnUnit.classList.toggle("active",m==="unit");
 btnFree.classList.toggle("active",m==="free");
 unitSection.style.display=m==="unit"?"block":"none";
 freeSection.style.display=m==="free"?"block":"none";
}

/* ===== VOICE ===== */
function playVoice(text){
 speechSynthesis.cancel();
 if(!voices.length) initVoices();

 const u=new SpeechSynthesisUtterance(text);
 u.voice =
   voices.find(v=>v.lang==="en-GB") ||
   voices.find(v=>v.lang==="en-US") ||
   voices[0];
 u.lang=u.voice.lang;
 u.rate=0.85;
 u.pitch=1.1;
 speechSynthesis.speak(u);
}

/* ===== SPEECH RECOGNITION ===== */
const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
const rec=new SR();
rec.lang="en-GB";

function startRec(){
 rec.start();
 recBtn.innerText="üéß ƒêANG NGHE‚Ä¶";
}

rec.onresult=e=>{
 const said=e.results[0][0].transcript;
 output.value=said;
 recBtn.innerText="üéôÔ∏è B·∫ÆT ƒê·∫¶U N√ìI";
 analyze(said);
};

/* ===== ANALYZE ===== */
function analyze(said){
 const s=lessons[unitSel.value].toLowerCase().split(" ");
 const i=said.toLowerCase().split(" ");
 let html="",mist=0;

 s.forEach(w=>{
  if(i.includes(w)) html+=`<span class="correct">${w}</span> `;
  else{
   html+=`<span class="fix" onclick="playVoice('${w}')">${w}</span> `;
   mist++;
  }
 });

 feedback.innerHTML=html;
 showCert(mist===0?5:4);
}

/* ===== CERT ===== */
function showCert(stars){
 cName.innerText=nameInp.value||"Student";
 cClass.innerText=classInp.value||"5/‚Ä¶";
 cUnit.innerText="Unit "+unitSel.value;
 cStars.innerText="‚≠ê".repeat(stars);
 cert.style.display="block";
}
</script>
</body>
</html>
